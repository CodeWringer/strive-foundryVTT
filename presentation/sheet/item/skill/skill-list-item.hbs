{{!-- Parameters:
viewModel: {SkillListItemViewModel}
cssClass: {undefined | String}
--}}
<div class="custom-system-list-item{{#if cssClass}} {{cssClass}}{{/if}}">
  {{!-- Row --}}
  <div class="flex flex-row flex-middle list-item-header">
    {{!-- Roll --}}
    {{> buttonRoll viewModel=viewModel.vmBtnRoll cssClass="" }}
    {{!-- Send to chat --}}
    {{> buttonSendToChat viewModel=viewModel.vmBtnSendToChat cssClass="" }}
    {{!-- Name --}}
    <span class="width-min-xl">
      {{#> label showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.character.skill.singular"}}{{/label}}
    </span>
    <div class="list-item-header-img">
      {{> inputImage viewModel=viewModel.vmImg cssClass="custom-icon-sm" }}
    </div>
    <div class="flex-grow margin-r-md">
      {{> inputTextField viewModel=viewModel.vmTfName cssClass="list-item-header" }}
    </div>
    {{!-- Context Menu --}}
    {{> buttonContextMenu viewModel=viewModel.vmBtnContextMenu cssClass="" }}
    {{!-- Delete --}}
    {{> buttonDelete viewModel=viewModel.vmBtnDelete cssClass="" }}
  </div>
  {{!-- Row --}}
  <div class="flex flex-row flex-wrap margin-b-md auto-margin-h">
    {{!-- Related Attribute --}}
    <div class="flex flex-row margin-b-sm">
      <i class="ico ico-related-attribute-solid dark" title="{{localize "ambersteel.character.skill.relatedAttribute"}}"></i>
      {{> inputDropDown viewModel=viewModel.vmDdRelatedAttribute }}
    </div>
    {{!-- Level --}}
    <div class="flex flex-row auto-margin-h">
      <div class="flex flex-row">
        <i class="ico ico-level-solid dark" title="{{localize "ambersteel.character.advancement.level"}}"></i>
        <div class="width-sm">
          {{> inputNumberSpinner viewModel=viewModel.vmNsLevel }}
        </div>
      </div>
      {{!-- Level Modifier --}}
      <div class="flex flex-row">
        <i class="ico ico-level-modifier-solid dark" title="{{localize "ambersteel.character.advancement.modifier.label"}}"></i>
        <div class="width-sm">
          {{> inputNumberSpinner viewModel=viewModel.vmNsLevelModifier }}
        </div>
      </div>
      {{!-- Modified Level --}}
      <div class="flex flex-middle">
        <span class="pad-t-md pad-b-md pad-r-md font-bold font-bold">=</span>
        {{#> readOnlyValue cssClass="width-sm font-size-lg flex flex-center"}}{{viewModel.modifiedLevel}}{{/readOnlyValue}}
      </div>
    </div>
    {{#if viewModel.showAdvancementProgression}}
    {{!-- Spacer --}}
    <div class="flex-grow"></div>
    {{!-- Advancement Requirements --}}
    <div class="flex flex-row">
      <div class="width-min-xl">
        {{#> label showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.character.advancement.requirements.successAndFailure.abbreviation"}}{{/label}}
      </div>
      <div class="width-min-md">
        {{#> readOnlyValue}}{{viewModel.successes}} / {{viewModel.failures}}{{/readOnlyValue}}
      </div>
    </div>
    {{!-- Successes --}}
    <div class="flex flex-row">
      <div class="width-min-l margin-l-sm">
        {{#> label showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.character.advancement.requirements.success.abbreviation"}}{{/label}}
      </div>
      <div class="width-md">
        {{> inputNumberSpinner viewModel=viewModel.vmNsSuccesses }}
      </div>
    </div>
    {{!-- Failures --}}
    <div class="flex flex-row">
      <div class="width-min-l margin-l-sm">
        {{#> label showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.character.advancement.requirements.failure.abbreviation"}}{{/label}}
      </div>
      <div class="width-md">
        {{> inputNumberSpinner viewModel=viewModel.vmNsFailures }}
      </div>
    </div>
    {{/if}}
  </div>
  {{!-- Row --}}
  {{!-- Description --}}
  <div class="flex flex-column margin-b-md border-solid-t-sm border-solid-b-sm">
    {{> inputRichText viewModel=viewModel.vmRtDescription }}
  </div>
  {{!-- Row --}}
  <div class="flex flex-row flex-wrap auto-margin">
    {{!-- AP cost --}}
    <div class="flex flex-row{{#if viewModel.hideApCost}} hidden{{/if}}">
      {{#> labeledControl viewModel=viewModel.vmNsApCost localizedLabel=(localize "ambersteel.actionPoint.abbreviation") }}
        <div class="width-sm">
          {{> inputNumberSpinner }}
        </div>
      {{/labeledControl}}
    </div>
    {{!-- Lots of optional content here --}}
    {{!-- Obstacle --}}
    <div class="flex flex-row{{#if viewModel.hideObstacle}} hidden{{/if}}">
      {{#> labeledControl viewModel=viewModel.vmTfObstacle localizedLabel=(localize "ambersteel.roll.obstacle.abbreviation") cssClass="flex-grow" }}
        {{> inputTextField }}
      {{/labeledControl}}
    </div>
    {{!-- Opposed By --}}
    <div class="flex flex-row{{#if viewModel.hideOpposedBy}} hidden{{/if}}">
      <div class="width-min-lg">
        {{#> label showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.roll.obstacle.opposedBy.label"}}{{/label}}
      </div>
      <div class="flex-grow">
        {{> inputTextField viewModel=viewModel.vmTfOpposedBy }}
      </div>
    </div>
    {{!-- Distance --}}
    <div class="flex flex-row{{#if viewModel.hideDistance}} hidden{{/if}}">
      <div class="width-min-lg">
        {{#> label showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.character.skill.ability.distance.label"}}{{/label}}
      </div>
      <div class="flex-grow">
        {{> inputTextField viewModel=viewModel.vmTfDistance }}
      </div>
    </div>
    {{!-- Attack type --}}
    <div class="flex flex-row{{#if viewModel.hideAttackType}} hidden{{/if}}">
      <div class="width-min-lg">
        {{#> label showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.attackType.label"}}{{/label}}
      </div>
      <div class="flex-grow">
        {{> inputDropDown viewModel=viewModel.vmDdAttackType }}
      </div>
    </div>
    {{!-- Condition --}}
    <div class="flex flex-row{{#if viewModel.hideCondition}} hidden{{/if}}">
      <div class="width-min-lg">
        {{#> label showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.character.skill.ability.condition.label"}}{{/label}}
      </div>
      <div class="flex-grow">
        {{> inputTextarea viewModel=viewModel.vmTaCondition }}
      </div>
    </div>
  </div>
  {{!-- Damage --}}
  <div class="flex flex-row{{#if viewModel.hideDamage}} hidden{{/if}}">
    <div class="flex flex-center">
      <span class="button light square font-size-default flex flex-center" id="{{viewModel.id}}-damage-info">
        <i class="far fa-question-circle info-button"></i>
      </span>
    </div>
    {{> damageDefinitionList viewModel=viewModel.vmDamageDefinitionList}}
  </div>
  {{!-- Row --}}
  {{!-- Prerequisites --}}
  <div class="flex flex-column margin-b-sm{{#if (neq viewModel.showPrerequisites true)}} hidden{{/if}}">
    {{#> header3 showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.character.skill.prerequisite.plural"}}{{/header3}}
    <ul class="unstyled-list">
      {{#each viewModel.prerequisites as |prerequisite index|}}
      <li class="flex flex-row flex-middle">
        <span class="flex flex-row flex-grow">
          {{#> readOnlyValue cssClass="flex flex-center"}}{{prerequisite.name}}{{/readOnlyValue}}
        </span>
        <span style="width: 144px">
          {{#> label showFancyFont=../viewModel.showFancyFont}}{{localize "ambersteel.character.advancement.minimum"}}{{/label}}
        </span>
        <span class="width-md">
          {{#> readOnlyValue cssClass="font-size-md flex flex-center"}}{{prerequisite.minimumLevel}}{{/readOnlyValue}}
        </span>
      </li>
      {{/each}}
    </ul>
  </div>
  {{!-- Row --}}
  {{!-- Category --}}
  <div class="flex flex-row">
    <i class="ico fas fa-folder" title="{{localize "ambersteel.general.category"}}"></i>
    <div class="width-xxl">
      {{> inputTextField viewModel=viewModel.vmTfCategory }}
    </div>
  </div>
  {{!-- Tags --}}
  <div class="flex flex-row margin-b-sm">
    <i class="ico ico-tags-solid dark" title="{{localize "ambersteel.general.tags.label"}}"></i>
    <span class="flex flex-grow">
      {{> inputTags viewModel=viewModel.vmTags }}
    </span>
  </div>
  {{!-- Row --}}
  {{!-- Skill Abilites --}}
  {{#if viewModel.showSkillAbilities}}
  {{#> header3 showFancyFont=viewModel.showFancyFont}}{{localize "ambersteel.character.skill.ability.plural"}}{{/header3}}
  {{> "systems/ambersteel/presentation/sheet/item/skill-ability/skill-ability-table.hbs" viewModel=viewModel.vmSkillAbilityTable cssClass=(ifThenElse viewModel.isSkillAbilityListVisible "" "hidden") }}
  {{/if}}
</div>
